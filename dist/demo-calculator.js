class e{static get PLUS_SYMBOL(){return"+"}static get MINUS_SYMBOL(){return"-"}static get MULTIPLY_SYMBOL(){return"x"}static get DIVIDE_SYMBOL(){return"รท"}static get DOT_SYMBOL(){return"."}get partsResult(){return this.__partsResult||(this.__partsResult=document.getElementById("partsResult")),this.__partsResult}get opResult(){return this.__opResult||(this.__opResult=document.getElementById("opResult")),this.__opResult}constructor(){this._actionHandler=this._actionHandler.bind(this),this._mouseUpHandler=this._mouseUpHandler.bind(this),this._keyDownHandler=this._keyDownHandler.bind(this),this.queue=[]}init(){const e=document.querySelectorAll("button.action");for(let t=0,s=e.length;t<s;t++)e[t].addEventListener("click",this._actionHandler),e[t].addEventListener("mouseup",this._mouseUpHandler);document.body.addEventListener("keydown",this._keyDownHandler)}_actionHandler(e){const t=e.target.dataset.value;switch(t){case"add":this.add();break;case"sub":this.subtract();break;case"mul":this.multiply();break;case"div":this.divide();break;case"dot":this.dot();break;case"sum":this.calculate();break;default:this.processNumber(t)}}_mouseUpHandler(e){e.target.blur()}add(){this._pushSumbol(e.PLUS_SYMBOL)}subtract(){const t=this.queue[this.queue.length-1];void 0===t||isNaN(t)?(this.queue[this.queue.length]=e.MINUS_SYMBOL,this.render()):this._pushSumbol(e.MINUS_SYMBOL)}multiply(){this._pushSumbol(e.MULTIPLY_SYMBOL)}divide(){this._pushSumbol(e.DIVIDE_SYMBOL)}dot(){const t=this.queue[this.queue.length-1];if(void 0===t||isNaN(t))this.queue[this.queue.length]=0;else if("string"==typeof t)return;this._pushSumbol(e.DOT_SYMBOL)}backspace(){const e=this.queue[this.queue.length-1];if(void 0!==e){if(isNaN(e))this.queue.pop();else{const t=Number.isInteger(e);let s=String(e);s&&1!==s.length?(s=s.substr(0,s.length-1),this.queue[this.queue.length-1]=t?Number(s):s):this.queue.pop()}this.render()}}_pushSumbol(e){const t=this.queue[this.queue.length-1];void 0!==t&&(isNaN(t)?this.queue[this.queue.length-1]=e:this.queue[this.queue.length]=e,this.render())}calculate(){const t=Array.from(this.queue);if(0!==t.length)if(isNaN(t[t.length-1])&&t.pop(),0!==t.length){for(let s=t.length-1;s>=0;s--){if(t[s]!==e.MINUS_SYMBOL)continue;const i=t[s-1],u=t[s+1];t[s+1]=-Number(u),isNaN(i)?t.splice(s,1):t[s]=e.PLUS_SYMBOL}for(let s=t.length-1;s>=0;s--){const i=t[s];if(i!==e.MULTIPLY_SYMBOL&&i!==e.DIVIDE_SYMBOL)continue;let u=t[s+1];if(!u&&i===e.DIVIDE_SYMBOL)return void this._divideByZeroError();const n=Number(t[s-1]);u=Number(u);const r=i===e.DIVIDE_SYMBOL?n/u:n*u;t.splice(s-1,3,r)}for(let s=t.length-1;s>=0;s--){const i=t[s];if(i!==e.PLUS_SYMBOL&&i!==e.MINUS_SYMBOL)continue;const u=Number(t[s+1]),n=Number(t[s-1]),r=i===e.PLUS_SYMBOL?n+u:n-u;t.splice(s-1,3,r)}this.opResult.innerText=t[0],this.queue=isNaN(t[0])?[]:t}else this.opResult.innerText=0;else this.opResult.innerText=0}_divideByZeroError(){this.opResult.innerText="Division by zero!"}processNumber(t){if((t=Number(t))==t){if(this.queue.length){let s=this.queue[this.queue.length-1];s===e.DOT_SYMBOL?(s=this._addFraction(this.queue[this.queue.length-2],t),this.queue.pop(),this.queue[this.queue.length-1]=s):isNaN(s)?this.queue.push(t):(s="string"==typeof s?this._addFraction(s,t):10*s+t,this.queue[this.queue.length-1]=s)}else this.queue.push(t);this.render()}else console.warn("Passed value is not a number.")}_addFraction(e,t){let s=String(e);return-1===s.indexOf(".")&&(s+="."),s+=t}render(){let t="";for(let s=0,i=this.queue.length;s<i;s++){const i=this.queue[s],u=this.queue[s+1];t&&(t+=" "),u===e.DOT_SYMBOL?(s++,t+=`${i}.${u}`):t+=i}t?this.partsResult.innerText=t:this.partsResult.innerHTML="&nbsp;"}_keyDownHandler(e){switch(e.key){case"Escape":this.clear();break;case"+":this.add();break;case"-":this.subtract();break;case"*":this.multiply();break;case"/":this.divide();break;case"=":this.calculate();break;case".":case",":this.dot();break;case"Backspace":this.backspace();break;default:if("NumpadEnter"===e.code)return void this.calculate();isNaN(e.key)||this.processNumber(e.key)}}clear(){this.opResult.innerText="0",this.partsResult.innerHTML="&nbsp;",this.queue=[]}}(new e).init();export{e as CalculatorApp};
//# sourceMappingURL=demo-calculator.js.map
